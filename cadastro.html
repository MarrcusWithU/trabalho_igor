<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tela de cadastro</title>
    <link rel="stylesheet" href="cadastro.css" />
</head>

<body>
    <div class="form-container">
        <div class="logo">
            <img src="imagens/logocadastro.png" alt="logo_cadastro" />
        </div>

        <hr />

        <form id="formCadastro">
            <label for="nome">NOME COMPLETO: </label>
            <input type="text" id="nome" name="nome" required />

            <label for="idade">IDADE: </label>
            <input type="number" id="idade" name="idade" required />

            <label for="nascimento">DATA DE NASCIMENTO: </label>
            <input type="date" id="nascimento" name="nascimento" required />

            <label for="celular">CELULAR: </label>
            <input type="tel" id="celular" name="celular" placeholder="(00) 00000-0000" required />

            <label for="email">DIGITE SEU E-MAIL: </label>
            <input type="email" id="email" name="email" placeholder="nomeusuario@gmail.com" required />

            <label for="senha">CRIE UMA SENHA: </label>
            <input type="password" id="senha" name="senha" required />

            <label for="confsenha">CONFIRME SUA SENHA: </label>
            <input type="password" id="confsenha" name="confsenha" placeholder="Repita a senha" required />

            <button type="submit">✅ Criar conta!</button>
        </form>
    </div>

    <script>
        document.getElementById('formCadastro').addEventListener('submit', function (event) {
            event.preventDefault();

            const nome = this.nome.value.trim();
            const idade = this.idade.value.trim();
            const nascimento = this.nascimento.value.trim();
            const celular = this.celular.value.trim();
            const email = this.email.value.trim().toLowerCase();
            const senha = this.senha.value.trim();
            const confsenha = this.confsenha.value.trim();

            if (senha !== confsenha) {
                alert("As senhas não coincidem!");
                return;
            }

            fetch('http://localhost:3000/cadastro', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ nome, idade, nascimento, celular, email, senha })
            })
                .then(res => {
                    if (!res.ok) {
                        return res.json().then(data => { throw data; });
                    }
                    return res.json();
                })
                .then(data => {
                    alert(data.mensagem);
                    window.location.href = "login.html"; // volta para login após cadastro
                })
                .catch(error => {
                    if (error.erro) {
                        alert("Erro: " + error.erro);
                    } else {
                        alert("Erro no cadastro.");
                    }
                });
        });
    </script>
</body>

</html>